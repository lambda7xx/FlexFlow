/home/ubuntu/.local/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py:293: UserWarning: torch.distributed.reduce_op is deprecated, please use torch.distributed.ReduceOp instead
  warnings.warn(
/home/ubuntu/flexgen/flexgen/utils.py:132: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  data_ptr = tensor.storage().data_ptr()
batch_size: 4 args.overlap: True , args.cut_gen_len: 5
<run_flexgen>: args.model: facebook/opt-13b
gen_len:92 and cut_gen_len:5
get_test_inputs, prompt_len:32 and batch_size:4
prompts:['Give three tips for staying healthy.', 'Give three tips for staying healthy.', 'Give three tips for staying healthy.', 'Give three tips for staying healthy.']
len(prompt):36
len(prompt):36
len(prompt):36
len(prompt):36
input_prompt:36
input_prompt:36
input_prompt:36
input_prompt:36
input_ids:[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 31033, 130, 4965, 13, 4959, 2245, 4], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 31033, 130, 4965, 13, 4959, 2245, 4], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 31033, 130, 4965, 13, 4959, 2245, 4], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 31033, 130, 4965, 13, 4959, 2245, 4]]
get_test_inputs, prompt_len:36 and batch_size:4
prompts:['Give three tips for staying healthy.', 'Give three tips for staying healthy.', 'Give three tips for staying healthy.', 'Give three tips for staying healthy.']
len(prompt):36
len(prompt):36
len(prompt):36
len(prompt):36
input_prompt:36
input_prompt:36
input_prompt:36
input_prompt:36
input_ids:[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 31033, 130, 4965, 13, 4959, 2245, 4], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 31033, 130, 4965, 13, 4959, 2245, 4], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 31033, 130, 4965, 13, 4959, 2245, 4], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 31033, 130, 4965, 13, 4959, 2245, 4]]
model size: 23.921 GB, cache size: 0.391 GB, hidden size (prefill): 0.005 GB
init weight...
num_layers:82 and num_gpu_batches:1
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
warmup - generate
benchmark - generate
num_prompts:4 and gen_len:92 and decode_latency:177.64065616099901 
Outputs:
----------------------------------------------------------------------
0: Give three tips for staying healthy.

1. Eat a balanced diet.

2. Exercise regularly.

3. Get enough sleep.

What is your favorite healthy food?

I love to eat a variety of foods. I love to eat a variety of foods. I love to eat a variety of foods. I love to eat a variety of foods. I love to eat a variety of foods. I love to eat a variety of foods. I love to
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
1: Give three tips for staying healthy.

1. Eat a balanced diet.

2. Exercise regularly.

3. Get enough sleep.

What is your favorite healthy food?

I love to eat a variety of foods. I love to eat a variety of foods. I love to eat a variety of foods. I love to eat a variety of foods. I love to eat a variety of foods. I love to eat a variety of foods. I love to
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
2: Give three tips for staying healthy.

1. Eat a balanced diet.

2. Exercise regularly.

3. Get enough sleep.

What is your favorite healthy food?

I love to eat a variety of foods. I love to eat a variety of foods. I love to eat a variety of foods. I love to eat a variety of foods. I love to eat a variety of foods. I love to eat a variety of foods. I love to
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
3: Give three tips for staying healthy.

1. Eat a balanced diet.

2. Exercise regularly.

3. Get enough sleep.

What is your favorite healthy food?

I love to eat a variety of foods. I love to eat a variety of foods. I love to eat a variety of foods. I love to eat a variety of foods. I love to eat a variety of foods. I love to eat a variety of foods. I love to
----------------------------------------------------------------------

TorchDevice: cuda:0
  cur_mem: 0.0079 GB,  peak_mem: 1.3917 GB
TorchDevice: cpu
  cur_mem: 24.4209 GB,  peak_mem: 0.0000 GB
model size: 23.921 GB	cache size: 0.391 GB	hidden size (p): 0.005 GB
peak gpu mem: 1.392 GB	projected: False
prefill latency: 1.955 s	prefill throughput: 73.673 token/s
decode latency: 177.641 s	decode throughput: 2.049 token/s
total latency: 179.595 s	total throughput: 2.049 token/s
