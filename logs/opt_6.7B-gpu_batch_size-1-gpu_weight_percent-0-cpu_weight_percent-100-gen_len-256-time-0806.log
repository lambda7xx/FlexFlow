/home/ubuntu/.local/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py:293: UserWarning: torch.distributed.reduce_op is deprecated, please use torch.distributed.ReduceOp instead
  warnings.warn(
/home/ubuntu/flexgen-0807/flexgen/utils.py:132: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  data_ptr = tensor.storage().data_ptr()
batch_size: 1 args.overlap: True , args.cut_gen_len: 5
<run_flexgen>: args.model: facebook/opt-6.7b
gen_len:92 and cut_gen_len:5
get_test_inputs, prompt_len:32 and batch_size:1
prompts:['Give three tips for staying healthy.']
len(prompt):36
input_prompt:36
input_ids:[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 31033, 130, 4965, 13, 4959, 2245, 4]]
get_test_inputs, prompt_len:36 and batch_size:1
prompts:['Give three tips for staying healthy.']
len(prompt):36
input_prompt:36
input_ids:[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 31033, 130, 4965, 13, 4959, 2245, 4]]
model size: 12.386 GB, cache size: 0.062 GB, hidden size (prefill): 0.001 GB
init weight...
num_layers:66 and num_gpu_batches:1
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
dtype:<class 'numpy.float16'>
warmup - generate
benchmark - generate
num_prompts:1 and gen_len:92 and decode_latency:49.69092978399203 
Outputs:
----------------------------------------------------------------------
0: Give three tips for staying healthy.

1. Eat a healthy diet.

2. Exercise regularly.

3. Get enough sleep.

What is your favorite healthy snack?

I love to eat fresh fruit.

What is your favorite healthy recipe?

I love to make smoothies.

What is your favorite healthy recipe?

I love to make smoothies.

What is your favorite healthy recipe?

I love to
----------------------------------------------------------------------

TorchDevice: cuda:0
  cur_mem: 0.0079 GB,  peak_mem: 0.8563 GB
TorchDevice: cpu
  cur_mem: 12.7859 GB,  peak_mem: 0.0000 GB
model size: 12.386 GB	cache size: 0.062 GB	hidden size (p): 0.001 GB
peak gpu mem: 0.856 GB	projected: False
prefill latency: 0.546 s	prefill throughput: 65.918 token/s
decode latency: 49.691 s	decode throughput: 1.831 token/s
total latency: 50.237 s	total throughput: 1.831 token/s
