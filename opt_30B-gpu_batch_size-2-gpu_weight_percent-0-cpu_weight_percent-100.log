/home/lambda/.local/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py:262: UserWarning: torch.distributed.reduce_op is deprecated, please use torch.distributed.ReduceOp instead
  warnings.warn(
batch_size: 2 args.overlap: True , args.cut_gen_len: 5
<run_flexgen>: args.model: facebook/opt-30b
get_test_inputs, prompt_len:32 and batch_size:2
prompts:['Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.', 'Write a short blog post (500 words) about the best dog toys for new dog owners.']
len(prompt):102
len(prompt):79
input_prompt:102
input_prompt:79
get_test_inputs, prompt_len:64 and batch_size:2
prompts:['Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.', 'Write a short blog post (500 words) about the best dog toys for new dog owners.']
len(prompt):102
len(prompt):79
input_prompt:102
input_prompt:79
model size: 55.803 GB, cache size: 0.492 GB, hidden size (prefill): 0.005 GB
init weight...
warmup - generate
benchmark - generate
decode_costs: [9.7244605040014, 9.697038033998979, 9.692551280999396, 9.567031257000053]
Outputs:
----------------------------------------------------------------------
0: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

The food cho
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
1: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

The food cho
----------------------------------------------------------------------

TorchDevice: cuda:0
  cur_mem: 0.0000 GB,  peak_mem: 1.9435 GB
TorchDevice: cpu
  cur_mem: 56.5031 GB,  peak_mem: 0.0000 GB
model size: 55.803 GB	cache size: 0.492 GB	hidden size (p): 0.005 GB
peak gpu mem: 1.944 GB	projected: True
prefill latency: 9.700 s	prefill throughput: 13.196 token/s
decode latency: 1223.145 s	decode throughput: 0.208 token/s
total latency: 1232.845 s	total throughput: 0.208 token/s
