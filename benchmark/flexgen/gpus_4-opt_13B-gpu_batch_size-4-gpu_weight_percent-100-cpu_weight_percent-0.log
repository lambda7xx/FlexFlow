batch_size: 4 args.overlap: True
Initializing distributed environment at 172.31.4.20:7777, world_size=4, rank=0, local_rank=0.
batch_size: 4 args.overlap: True
Initializing distributed environment at 172.31.4.20:7777, world_size=4, rank=3, local_rank=3.
batch_size: 4 args.overlap: True
Initializing distributed environment at 172.31.4.20:7777, world_size=4, rank=2, local_rank=2.
batch_size: 4 args.overlap: True
Initializing distributed environment at 172.31.4.20:7777, world_size=4, rank=1, local_rank=1.
rank #0: Finished initializing distributed environment
rank #3: Finished initializing distributed environment
rank #1: Finished initializing distributed environment
rank #2: Finished initializing distributed environment
rank #3: num_prompts:16 and args.num_gpu_batches:1 and args.gpu_batch_size:4 and num_inner_iterations:4
rank #3: prompt_len in dist_flex_opt:64
rank #3: get_test_inputs, prompt_len:32 and batch_size:4
rank #3: prompts:['Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.', 'Write a short blog post (500 words) about the best dog toys for new dog owners.', 'ChatGPT is rewriting Genesis.', 'Please write the evolution of humans by natural selection in the form of a recipe.']
rank #3: len(prompt):102
rank #3: len(prompt):79
rank #3: len(prompt):29
rank #3: len(prompt):82
rank #3: input_prompt:102
rank #3: input_prompt:79
rank #3: input_prompt:29
rank #3: input_prompt:82
rank #3: get_test_inputs, prompt_len:64 and batch_size:4
rank #3: prompts:['Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.', 'Write a short blog post (500 words) about the best dog toys for new dog owners.', 'ChatGPT is rewriting Genesis.', 'Please write the evolution of humans by natural selection in the form of a recipe.']
rank #3: len(prompt):102
rank #3: len(prompt):79
rank #3: len(prompt):29
rank #3: len(prompt):82
rank #3: input_prompt:102
rank #3: input_prompt:79
rank #3: input_prompt:29
rank #3: input_prompt:82
rank #3: args.offload_dir:~/flexgen_offload_dir
rank #2: num_prompts:16 and args.num_gpu_batches:1 and args.gpu_batch_size:4 and num_inner_iterations:4
rank #2: prompt_len in dist_flex_opt:64
rank #2: get_test_inputs, prompt_len:32 and batch_size:4
rank #2: prompts:['Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.', 'Write a short blog post (500 words) about the best dog toys for new dog owners.', 'ChatGPT is rewriting Genesis.', 'Please write the evolution of humans by natural selection in the form of a recipe.']
rank #2: len(prompt):102
rank #2: len(prompt):79
rank #2: len(prompt):29
rank #2: len(prompt):82
rank #2: input_prompt:102
rank #2: input_prompt:79
rank #2: input_prompt:29
rank #2: input_prompt:82
rank #2: get_test_inputs, prompt_len:64 and batch_size:4
rank #1: num_prompts:16 and args.num_gpu_batches:1 and args.gpu_batch_size:4 and num_inner_iterations:4
rank #1: prompt_len in dist_flex_opt:64
rank #1: get_test_inputs, prompt_len:32 and batch_size:4
rank #2: prompts:['Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.', 'Write a short blog post (500 words) about the best dog toys for new dog owners.', 'ChatGPT is rewriting Genesis.', 'Please write the evolution of humans by natural selection in the form of a recipe.']
rank #2: len(prompt):102
rank #2: len(prompt):79
rank #2: len(prompt):29
rank #2: len(prompt):82
rank #1: prompts:['Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.', 'Write a short blog post (500 words) about the best dog toys for new dog owners.', 'ChatGPT is rewriting Genesis.', 'Please write the evolution of humans by natural selection in the form of a recipe.']
rank #1: len(prompt):102
rank #1: len(prompt):79
rank #1: len(prompt):29
rank #1: len(prompt):82
rank #2: input_prompt:102
rank #2: input_prompt:79
rank #2: input_prompt:29
rank #2: input_prompt:82
rank #2: args.offload_dir:~/flexgen_offload_dir
rank #1: input_prompt:102
rank #1: input_prompt:79
rank #1: input_prompt:29
rank #1: input_prompt:82
rank #1: get_test_inputs, prompt_len:64 and batch_size:4
rank #1: prompts:['Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.', 'Write a short blog post (500 words) about the best dog toys for new dog owners.', 'ChatGPT is rewriting Genesis.', 'Please write the evolution of humans by natural selection in the form of a recipe.']
rank #1: len(prompt):102
rank #1: len(prompt):79
rank #1: len(prompt):29
rank #1: len(prompt):82
rank #1: input_prompt:102
rank #1: input_prompt:79
rank #1: input_prompt:29
rank #1: input_prompt:82
rank #1: args.offload_dir:~/flexgen_offload_dir
rank #0: num_prompts:16 and args.num_gpu_batches:1 and args.gpu_batch_size:4 and num_inner_iterations:4
rank #0: prompt_len in dist_flex_opt:64
rank #0: get_test_inputs, prompt_len:32 and batch_size:4
rank #0: prompts:['Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.', 'Write a short blog post (500 words) about the best dog toys for new dog owners.', 'ChatGPT is rewriting Genesis.', 'Please write the evolution of humans by natural selection in the form of a recipe.']
rank #0: len(prompt):102
rank #0: len(prompt):79
rank #0: len(prompt):29
rank #0: len(prompt):82
rank #0: input_prompt:102
rank #0: input_prompt:79
rank #0: input_prompt:29
rank #0: input_prompt:82
rank #0: get_test_inputs, prompt_len:64 and batch_size:4
rank #0: prompts:['Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.', 'Write a short blog post (500 words) about the best dog toys for new dog owners.', 'ChatGPT is rewriting Genesis.', 'Please write the evolution of humans by natural selection in the form of a recipe.']
rank #0: len(prompt):102
rank #0: len(prompt):79
rank #0: len(prompt):29
rank #0: len(prompt):82
rank #0: input_prompt:102
rank #0: input_prompt:79
rank #0: input_prompt:29
rank #0: input_prompt:82
rank #0: args.offload_dir:~/flexgen_offload_dir
rank #1: model size: 23.921 GB, cache size: 2.344 GB, hidden size (prefill): 0.029 GB
rank #1: warmup - generate
rank #2: model size: 23.921 GB, cache size: 2.344 GB, hidden size (prefill): 0.029 GB
rank #2: warmup - generate
rank #0: model size: 23.921 GB, cache size: 2.344 GB, hidden size (prefill): 0.029 GB
rank #0: warmup - generate
rank #3: model size: 23.921 GB, cache size: 2.344 GB, hidden size (prefill): 0.029 GB
rank #3: warmup - generate
rank #3: args.gen_len:128
rank #3: benchmark - generate
rank #2: args.gen_len:128
rank #2: benchmark - generate
rank #1: args.gen_len:128
rank #1: benchmark - generate
rank #0: args.gen_len:128
rank #0: benchmark - generate
rank #3: duration:0.9380054473876953
rank #2: duration:0.9380335807800293
rank #0: duration:0.9380161762237549
rank #1: duration:0.9380111694335938
rank #3: decode_costs: [0.12724768399857567, 0.12707399900045857, 0.12692974999936268, 0.12682184300047084]
rank #3: TorchDevice: cuda:3
rank #3:   cur_mem: 6.3401 GB,  peak_mem: 6.9494 GB
rank #3: TorchDevice: cpu
rank #3:   cur_mem: 0.0000 GB,  peak_mem: 0.0000 GB
rank #3: model size: 23.921 GB	cache size: 2.344 GB	hidden size (prefill): 0.029 GB
peak gpu mem: 6.949 GB
prefill latency: 0.37 s	prefill throughput: 2789.48 token/s
decode latency: 16.11 s	decode throughput: 126.10 token/s
total latency: 16.48 s	total throughput: 124.27 token/s
rank #3: len(outputs[i]:117)
rank #3: len(outputs[i]:117)
rank #3: Outputs:
----------------------------------------------------------------------
0: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.<s><s><s><s><s>
----------------------------------------------------------------------
15: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.<s><s><s><s><s>
----------------------------------------------------------------------

/home/lambda/.local/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py:262: UserWarning: torch.distributed.reduce_op is deprecated, please use torch.distributed.ReduceOp instead
  warnings.warn(
