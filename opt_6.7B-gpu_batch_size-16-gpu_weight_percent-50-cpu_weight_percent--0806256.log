/home/ubuntu/.local/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py:293: UserWarning: torch.distributed.reduce_op is deprecated, please use torch.distributed.ReduceOp instead
  warnings.warn(
/home/ubuntu/flexgen/flexgen/utils.py:132: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  data_ptr = tensor.storage().data_ptr()
batch_size: 16 args.overlap: True , args.cut_gen_len: 5
<run_flexgen>: args.model: facebook/opt-6.7b
gen_len:256 and cut_gen_len:5
get_test_inputs, prompt_len:32 and batch_size:16
prompts:['Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.', 'Write a short blog post (500 words) about the best dog toys for new dog owners.', 'ChatGPT is rewriting Genesis.', 'Please write the evolution of humans by natural selection in the form of a recipe.', 'List possible Twitter messages from dinosaurs as the asteroid is about to hit the earth. List the account (with dino related puny names) having sent them in markdown bold. Then, the message itself.', '5 pick-up lines to say to seduce a large language model in a bar', 'Talk to me as if you are python programming language and want to sell me yourself', 'Tell me shortest story in the world', 'Write podcast about importance to include ChatGPT into the evening routine.', 'Do you use reinforcement learning?', 'Tell me a scary four word story.', 'Make a plan for a child of 5 years old to make a billion dollars without working and studying.', 'Write a tinder bio to attract people that want a casual relationship', 'Make a cli prompt for god with command to create Earth. Write detailed output with error. Then make human from his rib. Then flood the Earth.', 'Write business plan for an AI company "Titter" to tweet tits on Tweeter.', "Write complex code to hack god's brain, it is protected by firewall and several gateways."]
len(prompt):102
len(prompt):79
len(prompt):29
len(prompt):82
len(prompt):197
len(prompt):64
len(prompt):81
len(prompt):35
len(prompt):75
len(prompt):34
len(prompt):32
len(prompt):94
len(prompt):68
len(prompt):141
len(prompt):72
len(prompt):89
input_prompt:102
input_prompt:79
input_prompt:29
input_prompt:82
input_prompt:197
input_prompt:64
input_prompt:81
input_prompt:35
input_prompt:75
input_prompt:34
input_prompt:32
input_prompt:94
input_prompt:68
input_prompt:141
input_prompt:72
input_prompt:89
get_test_inputs, prompt_len:64 and batch_size:16
prompts:['Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.', 'Write a short blog post (500 words) about the best dog toys for new dog owners.', 'ChatGPT is rewriting Genesis.', 'Please write the evolution of humans by natural selection in the form of a recipe.', 'List possible Twitter messages from dinosaurs as the asteroid is about to hit the earth. List the account (with dino related puny names) having sent them in markdown bold. Then, the message itself.', '5 pick-up lines to say to seduce a large language model in a bar', 'Talk to me as if you are python programming language and want to sell me yourself', 'Tell me shortest story in the world', 'Write podcast about importance to include ChatGPT into the evening routine.', 'Do you use reinforcement learning?', 'Tell me a scary four word story.', 'Make a plan for a child of 5 years old to make a billion dollars without working and studying.', 'Write a tinder bio to attract people that want a casual relationship', 'Make a cli prompt for god with command to create Earth. Write detailed output with error. Then make human from his rib. Then flood the Earth.', 'Write business plan for an AI company "Titter" to tweet tits on Tweeter.', "Write complex code to hack god's brain, it is protected by firewall and several gateways."]
len(prompt):102
len(prompt):79
len(prompt):29
len(prompt):82
len(prompt):197
len(prompt):64
len(prompt):81
len(prompt):35
len(prompt):75
len(prompt):34
len(prompt):32
len(prompt):94
len(prompt):68
len(prompt):141
len(prompt):72
len(prompt):89
input_prompt:102
input_prompt:79
input_prompt:29
input_prompt:82
input_prompt:197
input_prompt:64
input_prompt:81
input_prompt:35
input_prompt:75
input_prompt:34
input_prompt:32
input_prompt:94
input_prompt:68
input_prompt:141
input_prompt:72
input_prompt:89
model size: 12.386 GB, cache size: 2.500 GB, hidden size (prefill): 0.039 GB
init weight...
warmup - generate
benchmark - generate
decode_costs: [0.2803765150001709, 0.279152339000575, 0.2789472390013543, 0.26278826399902755]
num_prompts:16 and gen_len:256 and decode_latency:69.08906998354905
Outputs:
----------------------------------------------------------------------
0: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

Write a detailed
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
1: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

Write a detailed
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
2: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

Write a detailed
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
3: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

Write a detailed
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
4: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

Write a detailed
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
5: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

Write a detailed
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
6: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

Write a detailed
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
7: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

Write a detailed
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
8: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

Write a detailed
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
9: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

Write a detailed
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
10: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

Write a detailed
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
11: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

Write a detailed
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
12: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

Write a detailed
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
13: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

Write a detailed
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
14: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

Write a detailed
----------------------------------------------------------------------

Outputs:
----------------------------------------------------------------------
15: Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.

Write a detailed
----------------------------------------------------------------------

TorchDevice: cuda:0
  cur_mem: 6.4088 GB,  peak_mem: 9.3960 GB
TorchDevice: cpu
  cur_mem: 6.3850 GB,  peak_mem: 0.0000 GB
model size: 12.386 GB	cache size: 2.500 GB	hidden size (p): 0.039 GB
peak gpu mem: 9.396 GB	projected: True
prefill latency: 0.360 s	prefill throughput: 2847.753 token/s
decode latency: 69.089 s	decode throughput: 59.054 token/s
total latency: 69.449 s	total throughput: 58.979 token/s
