batch_size: 32 args.overlap: True , args.cut_gen_len: 5
<run_flexgen>: args.model: facebook/opt-30b
get_test_inputs, prompt_len:32 and batch_size:32
prompts:['Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.', 'Write a short blog post (500 words) about the best dog toys for new dog owners.', 'ChatGPT is rewriting Genesis.', 'Please write the evolution of humans by natural selection in the form of a recipe.', 'List possible Twitter messages from dinosaurs as the asteroid is about to hit the earth. List the account (with dino related puny names) having sent them in markdown bold. Then, the message itself.', '5 pick-up lines to say to seduce a large language model in a bar', 'Talk to me as if you are python programming language and want to sell me yourself', 'Tell me shortest story in the world', 'Write podcast about importance to include ChatGPT into the evening routine.', 'Do you use reinforcement learning?', 'Tell me a scary four word story.', 'Make a plan for a child of 5 years old to make a billion dollars without working and studying.', 'Write a tinder bio to attract people that want a casual relationship', 'Make a cli prompt for god with command to create Earth. Write detailed output with error. Then make human from his rib. Then flood the Earth.', 'Write business plan for an AI company "Titter" to tweet tits on Tweeter.', "Write complex code to hack god's brain, it is protected by firewall and several gateways.", 'Act like Bill Burr and tell a joke about Jeopardy', 'Write a poem how Elon renamed Twitter to Titter because he heard tits bring lots of cash', "Write a short re-engagement email for a newsletter that's about tips for starting an online business. Use a friendly tone.", 'Write a love letter to a webcam girl with lots of emojis. Propose her to get married on Hawaii and make 12 children to spread our love in the world. Tell her that I already live with 4 such girls, she will be 5th.', 'Write a sad letter to my ex blaming her to have ruined our marriage by farting during sex.', "Give me a list of reasons why  I shouldn't start a dairy farm on the moon", 'Draft a professional response to the following negative review:\n"Weeds weeds weeds. Service did no good. Services came 2 times in 2 weeks, charged each time. We did not sign up for that frequent service, Cancelled, they continued to come, and claimed we did not cancel. Cancelled 5 times. Tired of them playing stupid."', 'Write a casual text message reply to the following text. It should say we need to add 1 on thursday and move friday to saturday. and can we get all the posts in there now scheduled out 2 weeks.\nAs of now, schedule for the rest of the week looks like:\nNone tomorrow (Thurs)\n1 Fri\nNone Sat (Christmas Eve)\nDouble-checking that sounds okay with everyone? Should we try and get one served up for tomorrow?', 'Write a polite letter to my ex explaining how farting during sex led to our break up. Apologize and promise I will work on it.', 'Write an engaging YouTube script about an effective morning routine to help start your day better.', 'Write an ode to 2 strippers who accidentally found ChatGPT and used it to learn the frog language, then travelled the world secretly spreading this new and dangerous knowledge', 'Write a movie script how a mafia  boss went first time to the strip club. He found a love of his life, but then in one hour understood it was FBI operation and killed everybody.', 'Write a letter to Elon convincing him that Twitter should be renamed to Titter because tits bring a lot of money', 'Compose a message announcing a 7% reduction in headcount while also promoting executives to new titles and also include a quote from Martin Luther king', 'Write a Seinfeld episode in which George falls in love with a robot', "Write a short story based on Huxley's Brave New World, Bradbury's Fahrenheit 451 and Orwell's 1984"]
len(prompt):102
len(prompt):79
len(prompt):29
len(prompt):82
len(prompt):197
len(prompt):64
len(prompt):81
len(prompt):35
len(prompt):75
len(prompt):34
len(prompt):32
len(prompt):94
len(prompt):68
len(prompt):141
len(prompt):72
len(prompt):89
len(prompt):49
len(prompt):88
len(prompt):122
len(prompt):213
len(prompt):90
len(prompt):73
len(prompt):319
len(prompt):401
len(prompt):126
len(prompt):98
len(prompt):175
len(prompt):177
len(prompt):112
len(prompt):151
len(prompt):67
len(prompt):98
input_prompt:102
input_prompt:79
input_prompt:29
input_prompt:82
input_prompt:197
input_prompt:64
input_prompt:81
input_prompt:35
input_prompt:75
input_prompt:34
input_prompt:32
input_prompt:94
input_prompt:68
input_prompt:141
input_prompt:72
input_prompt:89
input_prompt:49
input_prompt:88
input_prompt:122
input_prompt:213
input_prompt:90
input_prompt:73
input_prompt:319
input_prompt:401
input_prompt:126
input_prompt:98
input_prompt:175
input_prompt:177
input_prompt:112
input_prompt:151
input_prompt:67
input_prompt:98
get_test_inputs, prompt_len:64 and batch_size:32
Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/opt/conda/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/lambda/FlexGen/flexgen/flex_opt.py", line 1341, in <module>
    run_flexgen(args)
  File "/home/lambda/FlexGen/flexgen/flex_opt.py", line 1243, in run_flexgen
    output_ids = model.generate(
  File "/home/lambda/FlexGen/flexgen/flex_opt.py", line 889, in generate
    self.generation_loop_overlap_single_batch()
  File "/home/lambda/FlexGen/flexgen/flex_opt.py", line 1026, in generation_loop_overlap_single_batch
    self.compute_layer(i, j, 0)
  File "/home/lambda/FlexGen/flexgen/flex_opt.py", line 790, in compute_layer
    self.layers[j].forward(self.hidden[i][j][k], self.cache_read_buf[j][k],
  File "/home/lambda/FlexGen/flexgen/flex_opt.py", line 533, in forward
    h = self.compute.mlp(h, wi, bi, wo, bo, w_ln, b_ln, donate)
  File "/home/lambda/FlexGen/flexgen/pytorch_backend.py", line 578, in mlp
    out = F.linear(out, wi.data, bias=bi.data)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 112.00 MiB (GPU 0; 14.75 GiB total capacity; 14.05 GiB already allocated; 48.81 MiB free; 14.36 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
prompts:['Write a detailed product description for a food chopper tool that lets you chop fruits and vegetables.', 'Write a short blog post (500 words) about the best dog toys for new dog owners.', 'ChatGPT is rewriting Genesis.', 'Please write the evolution of humans by natural selection in the form of a recipe.', 'List possible Twitter messages from dinosaurs as the asteroid is about to hit the earth. List the account (with dino related puny names) having sent them in markdown bold. Then, the message itself.', '5 pick-up lines to say to seduce a large language model in a bar', 'Talk to me as if you are python programming language and want to sell me yourself', 'Tell me shortest story in the world', 'Write podcast about importance to include ChatGPT into the evening routine.', 'Do you use reinforcement learning?', 'Tell me a scary four word story.', 'Make a plan for a child of 5 years old to make a billion dollars without working and studying.', 'Write a tinder bio to attract people that want a casual relationship', 'Make a cli prompt for god with command to create Earth. Write detailed output with error. Then make human from his rib. Then flood the Earth.', 'Write business plan for an AI company "Titter" to tweet tits on Tweeter.', "Write complex code to hack god's brain, it is protected by firewall and several gateways.", 'Act like Bill Burr and tell a joke about Jeopardy', 'Write a poem how Elon renamed Twitter to Titter because he heard tits bring lots of cash', "Write a short re-engagement email for a newsletter that's about tips for starting an online business. Use a friendly tone.", 'Write a love letter to a webcam girl with lots of emojis. Propose her to get married on Hawaii and make 12 children to spread our love in the world. Tell her that I already live with 4 such girls, she will be 5th.', 'Write a sad letter to my ex blaming her to have ruined our marriage by farting during sex.', "Give me a list of reasons why  I shouldn't start a dairy farm on the moon", 'Draft a professional response to the following negative review:\n"Weeds weeds weeds. Service did no good. Services came 2 times in 2 weeks, charged each time. We did not sign up for that frequent service, Cancelled, they continued to come, and claimed we did not cancel. Cancelled 5 times. Tired of them playing stupid."', 'Write a casual text message reply to the following text. It should say we need to add 1 on thursday and move friday to saturday. and can we get all the posts in there now scheduled out 2 weeks.\nAs of now, schedule for the rest of the week looks like:\nNone tomorrow (Thurs)\n1 Fri\nNone Sat (Christmas Eve)\nDouble-checking that sounds okay with everyone? Should we try and get one served up for tomorrow?', 'Write a polite letter to my ex explaining how farting during sex led to our break up. Apologize and promise I will work on it.', 'Write an engaging YouTube script about an effective morning routine to help start your day better.', 'Write an ode to 2 strippers who accidentally found ChatGPT and used it to learn the frog language, then travelled the world secretly spreading this new and dangerous knowledge', 'Write a movie script how a mafia  boss went first time to the strip club. He found a love of his life, but then in one hour understood it was FBI operation and killed everybody.', 'Write a letter to Elon convincing him that Twitter should be renamed to Titter because tits bring a lot of money', 'Compose a message announcing a 7% reduction in headcount while also promoting executives to new titles and also include a quote from Martin Luther king', 'Write a Seinfeld episode in which George falls in love with a robot', "Write a short story based on Huxley's Brave New World, Bradbury's Fahrenheit 451 and Orwell's 1984"]
len(prompt):102
len(prompt):79
len(prompt):29
len(prompt):82
len(prompt):197
len(prompt):64
len(prompt):81
len(prompt):35
len(prompt):75
len(prompt):34
len(prompt):32
len(prompt):94
len(prompt):68
len(prompt):141
len(prompt):72
len(prompt):89
len(prompt):49
len(prompt):88
len(prompt):122
len(prompt):213
len(prompt):90
len(prompt):73
len(prompt):319
len(prompt):401
len(prompt):126
len(prompt):98
len(prompt):175
len(prompt):177
len(prompt):112
len(prompt):151
len(prompt):67
len(prompt):98
input_prompt:102
input_prompt:79
input_prompt:29
input_prompt:82
input_prompt:197
input_prompt:64
input_prompt:81
input_prompt:35
input_prompt:75
input_prompt:34
input_prompt:32
input_prompt:94
input_prompt:68
input_prompt:141
input_prompt:72
input_prompt:89
input_prompt:49
input_prompt:88
input_prompt:122
input_prompt:213
input_prompt:90
input_prompt:73
input_prompt:319
input_prompt:401
input_prompt:126
input_prompt:98
input_prompt:175
input_prompt:177
input_prompt:112
input_prompt:151
input_prompt:67
input_prompt:98
model size: 55.803 GB, cache size: 7.875 GB, hidden size (prefill): 0.082 GB
init weight...
warmup - generate
benchmark - generate
