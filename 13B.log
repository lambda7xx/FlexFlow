<run_flexgen>: args.model: facebook/opt-13b
Downloading (…)okenizer_config.json:   0%|          | 0.00/685 [00:00<?, ?B/s]Downloading (…)okenizer_config.json: 100%|██████████| 685/685 [00:00<00:00, 6.81MB/s]
Downloading (…)lve/main/config.json:   0%|          | 0.00/651 [00:00<?, ?B/s]Downloading (…)lve/main/config.json: 100%|██████████| 651/651 [00:00<00:00, 7.67MB/s]
Downloading (…)olve/main/vocab.json:   0%|          | 0.00/899k [00:00<?, ?B/s]Downloading (…)olve/main/vocab.json: 100%|██████████| 899k/899k [00:00<00:00, 19.5MB/s]
Downloading (…)olve/main/merges.txt:   0%|          | 0.00/456k [00:00<?, ?B/s]Downloading (…)olve/main/merges.txt: 100%|██████████| 456k/456k [00:00<00:00, 37.0MB/s]
Downloading (…)cial_tokens_map.json:   0%|          | 0.00/221 [00:00<?, ?B/s]Downloading (…)cial_tokens_map.json: 100%|██████████| 221/221 [00:00<00:00, 2.40MB/s]
model size: 23.921 GB, cache size: 1.660 GB, hidden size (prefill): 0.021 GB
init weight...
Load the pre-trained pytorch weights of opt-13b from huggingface. The downloading and cpu loading can take dozens of minutes. If it seems to get stuck, you can monitor the progress by checking the memory usage of this process.
Fetching 3 files:   0%|          | 0/3 [00:00<?, ?it/s]Fetching 3 files: 100%|██████████| 3/3 [00:00<00:00, 34473.73it/s]
Convert format:   0%|          | 0/3 [00:00<?, ?it/s]
  0%|          | 0/244 [00:00<?, ?it/s][A
  0%|          | 1/244 [00:00<02:43,  1.49it/s][A
  4%|▎         | 9/244 [00:00<00:15, 14.82it/s][A
  6%|▌         | 15/244 [00:00<00:10, 20.85it/s][A
  8%|▊         | 19/244 [00:01<00:09, 22.98it/s][A
 10%|█         | 25/244 [00:01<00:07, 30.52it/s][A
 13%|█▎        | 31/244 [00:01<00:06, 32.03it/s][A
 15%|█▍        | 36/244 [00:01<00:06, 33.26it/s][A
 17%|█▋        | 41/244 [00:01<00:05, 36.83it/s][A
 19%|█▉        | 47/244 [00:01<00:05, 36.36it/s][A
 21%|██▏       | 52/244 [00:01<00:05, 36.50it/s][A
 23%|██▎       | 57/244 [00:02<00:04, 39.47it/s][A
 26%|██▌       | 63/244 [00:02<00:04, 37.94it/s][A
 28%|██▊       | 68/244 [00:02<00:04, 37.54it/s][A
 30%|██▉       | 73/244 [00:02<00:04, 40.20it/s][A
 32%|███▏      | 79/244 [00:02<00:04, 38.37it/s][A
 34%|███▍      | 83/244 [00:02<00:04, 35.76it/s][A
 36%|███▋      | 89/244 [00:02<00:03, 41.10it/s][A
 39%|███▉      | 95/244 [00:03<00:03, 38.89it/s][A
 41%|████      | 100/244 [00:03<00:03, 38.18it/s][A
 43%|████▎     | 105/244 [00:03<00:03, 40.61it/s][A
 45%|████▌     | 111/244 [00:03<00:03, 38.57it/s][A
 47%|████▋     | 115/244 [00:03<00:03, 35.89it/s][A
 50%|████▉     | 121/244 [00:03<00:02, 41.31it/s][A
 52%|█████▏    | 127/244 [00:03<00:02, 39.09it/s][A
 54%|█████▍    | 132/244 [00:03<00:02, 38.45it/s][A
 56%|█████▌    | 137/244 [00:04<00:02, 40.90it/s][A
 59%|█████▊    | 143/244 [00:04<00:02, 38.80it/s][A
 61%|██████    | 148/244 [00:04<00:02, 38.14it/s][A
 63%|██████▎   | 153/244 [00:04<00:02, 40.69it/s][A
 65%|██████▌   | 159/244 [00:04<00:02, 38.67it/s][A
 67%|██████▋   | 163/244 [00:04<00:02, 36.01it/s][A
 69%|██████▉   | 169/244 [00:04<00:01, 41.39it/s][A
 72%|███████▏  | 175/244 [00:05<00:01, 39.19it/s][A
 74%|███████▍  | 180/244 [00:05<00:01, 38.41it/s][A
 76%|███████▌  | 185/244 [00:05<00:01, 40.88it/s][A
 78%|███████▊  | 191/244 [00:05<00:01, 38.77it/s][A
 80%|████████  | 196/244 [00:05<00:01, 38.08it/s][A
 82%|████████▏ | 201/244 [00:05<00:01, 40.70it/s][A
 85%|████████▍ | 207/244 [00:05<00:00, 38.74it/s][A
 87%|████████▋ | 212/244 [00:06<00:00, 38.11it/s][A
 89%|████████▉ | 217/244 [00:06<00:00, 40.60it/s][A
 91%|█████████▏| 223/244 [00:06<00:00, 38.65it/s][A
 93%|█████████▎| 227/244 [00:06<00:00, 35.87it/s][A
 95%|█████████▌| 233/244 [00:06<00:00, 41.26it/s][A
 98%|█████████▊| 239/244 [00:06<00:00, 39.04it/s][A
100%|██████████| 244/244 [00:06<00:00, 38.27it/s][A
                                                 [AConvert format:  33%|███▎      | 1/3 [00:15<00:30, 15.47s/it]
  0%|          | 0/252 [00:00<?, ?it/s][A
  2%|▏         | 5/252 [00:00<00:05, 48.55it/s][A
  4%|▍         | 11/252 [00:00<00:06, 39.20it/s][A
  6%|▋         | 16/252 [00:00<00:06, 38.01it/s][A
  8%|▊         | 21/252 [00:00<00:05, 41.52it/s][A
 11%|█         | 27/252 [00:00<00:05, 38.58it/s][A
 12%|█▏        | 31/252 [00:00<00:06, 35.45it/s][A
 15%|█▍        | 37/252 [00:00<00:05, 41.40it/s][A
 17%|█▋        | 43/252 [00:01<00:05, 38.96it/s][A
 19%|█▉        | 48/252 [00:01<00:05, 38.23it/s][A
 21%|██        | 53/252 [00:01<00:04, 40.88it/s][A
 23%|██▎       | 59/252 [00:01<00:04, 38.80it/s][A
 25%|██▌       | 64/252 [00:01<00:04, 38.05it/s][A
 27%|██▋       | 69/252 [00:01<00:04, 40.50it/s][A
 30%|██▉       | 75/252 [00:01<00:04, 38.47it/s][A
 31%|███▏      | 79/252 [00:02<00:04, 35.70it/s][A
 34%|███▎      | 85/252 [00:02<00:04, 41.02it/s][A
 36%|███▌      | 91/252 [00:02<00:04, 38.71it/s][A
 38%|███▊      | 96/252 [00:02<00:04, 37.84it/s][A
 40%|████      | 101/252 [00:02<00:03, 40.15it/s][A
 42%|████▏     | 107/252 [00:02<00:03, 38.24it/s][A
 44%|████▍     | 111/252 [00:02<00:03, 35.63it/s][A
 46%|████▋     | 117/252 [00:02<00:03, 40.98it/s][A
 49%|████▉     | 123/252 [00:03<00:03, 38.95it/s][A
 51%|█████     | 128/252 [00:03<00:03, 38.28it/s][A
 53%|█████▎    | 133/252 [00:03<00:02, 40.76it/s][A
 55%|█████▌    | 139/252 [00:03<00:02, 38.66it/s][A
 57%|█████▋    | 144/252 [00:03<00:02, 37.98it/s][A
 59%|█████▉    | 149/252 [00:03<00:02, 40.51it/s][A
 62%|██████▏   | 155/252 [00:03<00:02, 38.56it/s][A
 63%|██████▎   | 159/252 [00:04<00:02, 35.87it/s][A
 65%|██████▌   | 165/252 [00:04<00:02, 41.31it/s][A
 68%|██████▊   | 171/252 [00:04<00:02, 38.94it/s][A
 70%|██████▉   | 176/252 [00:04<00:02, 37.96it/s][A
 72%|███████▏  | 181/252 [00:04<00:01, 40.32it/s][A
 74%|███████▍  | 187/252 [00:04<00:01, 38.31it/s][A
 76%|███████▌  | 191/252 [00:04<00:01, 35.58it/s][A
 78%|███████▊  | 197/252 [00:05<00:01, 40.94it/s][A
 81%|████████  | 203/252 [00:05<00:01, 38.87it/s][A
 83%|████████▎ | 208/252 [00:05<00:01, 38.08it/s][A
 85%|████████▍ | 213/252 [00:05<00:00, 40.54it/s][A
 87%|████████▋ | 219/252 [00:05<00:00, 38.45it/s][A
 88%|████████▊ | 223/252 [00:05<00:00, 35.66it/s][A
 91%|█████████ | 229/252 [00:05<00:00, 40.99it/s][A
 93%|█████████▎| 235/252 [00:06<00:00, 38.84it/s][A
 95%|█████████▌| 240/252 [00:06<00:00, 38.10it/s][A
 97%|█████████▋| 245/252 [00:06<00:00, 40.56it/s][A
100%|█████████▉| 251/252 [00:06<00:00, 38.50it/s][A
                                                 [AConvert format:  67%|██████▋   | 2/3 [00:27<00:13, 13.58s/it]
  0%|          | 0/148 [00:00<?, ?it/s][A
  1%|          | 1/148 [00:00<00:20,  7.33it/s][A
  6%|▌         | 9/148 [00:00<00:03, 43.78it/s][A
 10%|█         | 15/148 [00:00<00:03, 38.88it/s][A
 14%|█▎        | 20/148 [00:00<00:03, 37.86it/s][A
 17%|█▋        | 25/148 [00:00<00:03, 40.95it/s][A
 21%|██        | 31/148 [00:00<00:03, 38.47it/s][A
 24%|██▍       | 36/148 [00:00<00:02, 37.78it/s][A
 28%|██▊       | 41/148 [00:01<00:02, 40.54it/s][A
 32%|███▏      | 47/148 [00:01<00:02, 38.53it/s][A
 34%|███▍      | 51/148 [00:01<00:02, 35.69it/s][A
 39%|███▊      | 57/148 [00:01<00:02, 41.29it/s][A
 43%|████▎     | 63/148 [00:01<00:02, 38.96it/s][A
 46%|████▌     | 68/148 [00:01<00:02, 38.20it/s][A
 49%|████▉     | 73/148 [00:01<00:01, 40.70it/s][A
 53%|█████▎    | 79/148 [00:02<00:01, 38.70it/s][A
 57%|█████▋    | 84/148 [00:02<00:01, 38.00it/s][A
 60%|██████    | 89/148 [00:02<00:01, 40.55it/s][A
 64%|██████▍   | 95/148 [00:02<00:01, 38.52it/s][A
 67%|██████▋   | 99/148 [00:02<00:01, 35.71it/s][A
 71%|███████   | 105/148 [00:02<00:01, 41.05it/s][A
 75%|███████▌  | 111/148 [00:02<00:00, 38.78it/s][A
 78%|███████▊  | 116/148 [00:03<00:00, 38.08it/s][A
 82%|████████▏ | 121/148 [00:03<00:00, 40.56it/s][A
 86%|████████▌ | 127/148 [00:03<00:00, 38.56it/s][A
 89%|████████▊ | 131/148 [00:03<00:00, 35.78it/s][A
 93%|█████████▎| 137/148 [00:03<00:00, 41.08it/s][A
 97%|█████████▋| 143/148 [00:03<00:00, 38.91it/s][A
100%|██████████| 148/148 [00:03<00:00, 38.31it/s][A
                                                 [AConvert format: 100%|██████████| 3/3 [00:35<00:00, 10.77s/it]Convert format: 100%|██████████| 3/3 [00:35<00:00, 11.72s/it]
/home/lambda/.local/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py:262: UserWarning: torch.distributed.reduce_op is deprecated, please use torch.distributed.ReduceOp instead
  warnings.warn(
warmup - generate
benchmark - generate
Outputs:
----------------------------------------------------------------------
0: Paris is the capital city of France. It is the most visited city in the world. It is also the most visited city in Europe. It is the most visited city in the world.
----------------------------------------------------------------------
3: Paris is the capital city of France. It is the most visited city in the world. It is also the most visited city in Europe. It is the most visited city in the world.
----------------------------------------------------------------------

TorchDevice: cuda:0
  cur_mem: 0.0000 GB,  peak_mem: 2.9085 GB
TorchDevice: cpu
  cur_mem: 24.4209 GB,  peak_mem: 0.0000 GB
model size: 23.921 GB	cache size: 1.660 GB	hidden size (p): 0.021 GB
peak gpu mem: 2.908 GB	projected: False
prefill latency: 4.205 s	prefill throughput: 486.996 token/s
decode latency: 129.830 s	decode throughput: 0.955 token/s
total latency: 134.035 s	total throughput: 0.955 token/s
