<run_flexgen>: args.model: facebook/opt-13b
Downloading (â€¦)okenizer_config.json:   0%|          | 0.00/685 [00:00<?, ?B/s]Downloading (â€¦)okenizer_config.json: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 685/685 [00:00<00:00, 6.81MB/s]
Downloading (â€¦)lve/main/config.json:   0%|          | 0.00/651 [00:00<?, ?B/s]Downloading (â€¦)lve/main/config.json: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 651/651 [00:00<00:00, 7.67MB/s]
Downloading (â€¦)olve/main/vocab.json:   0%|          | 0.00/899k [00:00<?, ?B/s]Downloading (â€¦)olve/main/vocab.json: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 899k/899k [00:00<00:00, 19.5MB/s]
Downloading (â€¦)olve/main/merges.txt:   0%|          | 0.00/456k [00:00<?, ?B/s]Downloading (â€¦)olve/main/merges.txt: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 456k/456k [00:00<00:00, 37.0MB/s]
Downloading (â€¦)cial_tokens_map.json:   0%|          | 0.00/221 [00:00<?, ?B/s]Downloading (â€¦)cial_tokens_map.json: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 221/221 [00:00<00:00, 2.40MB/s]
model size: 23.921 GB, cache size: 1.660 GB, hidden size (prefill): 0.021 GB
init weight...
Load the pre-trained pytorch weights of opt-13b from huggingface. The downloading and cpu loading can take dozens of minutes. If it seems to get stuck, you can monitor the progress by checking the memory usage of this process.
Fetching 3 files:   0%|          | 0/3 [00:00<?, ?it/s]Fetching 3 files: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00, 34473.73it/s]
Convert format:   0%|          | 0/3 [00:00<?, ?it/s]
  0%|          | 0/244 [00:00<?, ?it/s][A
  0%|          | 1/244 [00:00<02:43,  1.49it/s][A
  4%|â–Ž         | 9/244 [00:00<00:15, 14.82it/s][A
  6%|â–Œ         | 15/244 [00:00<00:10, 20.85it/s][A
  8%|â–Š         | 19/244 [00:01<00:09, 22.98it/s][A
 10%|â–ˆ         | 25/244 [00:01<00:07, 30.52it/s][A
 13%|â–ˆâ–Ž        | 31/244 [00:01<00:06, 32.03it/s][A
 15%|â–ˆâ–        | 36/244 [00:01<00:06, 33.26it/s][A
 17%|â–ˆâ–‹        | 41/244 [00:01<00:05, 36.83it/s][A
 19%|â–ˆâ–‰        | 47/244 [00:01<00:05, 36.36it/s][A
 21%|â–ˆâ–ˆâ–       | 52/244 [00:01<00:05, 36.50it/s][A
 23%|â–ˆâ–ˆâ–Ž       | 57/244 [00:02<00:04, 39.47it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 63/244 [00:02<00:04, 37.94it/s][A
 28%|â–ˆâ–ˆâ–Š       | 68/244 [00:02<00:04, 37.54it/s][A
 30%|â–ˆâ–ˆâ–‰       | 73/244 [00:02<00:04, 40.20it/s][A
 32%|â–ˆâ–ˆâ–ˆâ–      | 79/244 [00:02<00:04, 38.37it/s][A
 34%|â–ˆâ–ˆâ–ˆâ–      | 83/244 [00:02<00:04, 35.76it/s][A
 36%|â–ˆâ–ˆâ–ˆâ–‹      | 89/244 [00:02<00:03, 41.10it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 95/244 [00:03<00:03, 38.89it/s][A
 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 100/244 [00:03<00:03, 38.18it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 105/244 [00:03<00:03, 40.61it/s][A
 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 111/244 [00:03<00:03, 38.57it/s][A
 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 115/244 [00:03<00:03, 35.89it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 121/244 [00:03<00:02, 41.31it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 127/244 [00:03<00:02, 39.09it/s][A
 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 132/244 [00:03<00:02, 38.45it/s][A
 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 137/244 [00:04<00:02, 40.90it/s][A
 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 143/244 [00:04<00:02, 38.80it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 148/244 [00:04<00:02, 38.14it/s][A
 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 153/244 [00:04<00:02, 40.69it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 159/244 [00:04<00:02, 38.67it/s][A
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 163/244 [00:04<00:02, 36.01it/s][A
 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 169/244 [00:04<00:01, 41.39it/s][A
 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 175/244 [00:05<00:01, 39.19it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 180/244 [00:05<00:01, 38.41it/s][A
 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 185/244 [00:05<00:01, 40.88it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 191/244 [00:05<00:01, 38.77it/s][A
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 196/244 [00:05<00:01, 38.08it/s][A
 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 201/244 [00:05<00:01, 40.70it/s][A
 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 207/244 [00:05<00:00, 38.74it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 212/244 [00:06<00:00, 38.11it/s][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 217/244 [00:06<00:00, 40.60it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 223/244 [00:06<00:00, 38.65it/s][A
 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 227/244 [00:06<00:00, 35.87it/s][A
 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 233/244 [00:06<00:00, 41.26it/s][A
 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 239/244 [00:06<00:00, 39.04it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 244/244 [00:06<00:00, 38.27it/s][A
                                                 [AConvert format:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:15<00:30, 15.47s/it]
  0%|          | 0/252 [00:00<?, ?it/s][A
  2%|â–         | 5/252 [00:00<00:05, 48.55it/s][A
  4%|â–         | 11/252 [00:00<00:06, 39.20it/s][A
  6%|â–‹         | 16/252 [00:00<00:06, 38.01it/s][A
  8%|â–Š         | 21/252 [00:00<00:05, 41.52it/s][A
 11%|â–ˆ         | 27/252 [00:00<00:05, 38.58it/s][A
 12%|â–ˆâ–        | 31/252 [00:00<00:06, 35.45it/s][A
 15%|â–ˆâ–        | 37/252 [00:00<00:05, 41.40it/s][A
 17%|â–ˆâ–‹        | 43/252 [00:01<00:05, 38.96it/s][A
 19%|â–ˆâ–‰        | 48/252 [00:01<00:05, 38.23it/s][A
 21%|â–ˆâ–ˆ        | 53/252 [00:01<00:04, 40.88it/s][A
 23%|â–ˆâ–ˆâ–Ž       | 59/252 [00:01<00:04, 38.80it/s][A
 25%|â–ˆâ–ˆâ–Œ       | 64/252 [00:01<00:04, 38.05it/s][A
 27%|â–ˆâ–ˆâ–‹       | 69/252 [00:01<00:04, 40.50it/s][A
 30%|â–ˆâ–ˆâ–‰       | 75/252 [00:01<00:04, 38.47it/s][A
 31%|â–ˆâ–ˆâ–ˆâ–      | 79/252 [00:02<00:04, 35.70it/s][A
 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 85/252 [00:02<00:04, 41.02it/s][A
 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 91/252 [00:02<00:04, 38.71it/s][A
 38%|â–ˆâ–ˆâ–ˆâ–Š      | 96/252 [00:02<00:04, 37.84it/s][A
 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 101/252 [00:02<00:03, 40.15it/s][A
 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 107/252 [00:02<00:03, 38.24it/s][A
 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 111/252 [00:02<00:03, 35.63it/s][A
 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 117/252 [00:02<00:03, 40.98it/s][A
 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 123/252 [00:03<00:03, 38.95it/s][A
 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 128/252 [00:03<00:03, 38.28it/s][A
 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 133/252 [00:03<00:02, 40.76it/s][A
 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 139/252 [00:03<00:02, 38.66it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 144/252 [00:03<00:02, 37.98it/s][A
 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 149/252 [00:03<00:02, 40.51it/s][A
 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 155/252 [00:03<00:02, 38.56it/s][A
 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 159/252 [00:04<00:02, 35.87it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 165/252 [00:04<00:02, 41.31it/s][A
 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 171/252 [00:04<00:02, 38.94it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 176/252 [00:04<00:02, 37.96it/s][A
 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 181/252 [00:04<00:01, 40.32it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 187/252 [00:04<00:01, 38.31it/s][A
 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 191/252 [00:04<00:01, 35.58it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 197/252 [00:05<00:01, 40.94it/s][A
 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 203/252 [00:05<00:01, 38.87it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 208/252 [00:05<00:01, 38.08it/s][A
 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 213/252 [00:05<00:00, 40.54it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 219/252 [00:05<00:00, 38.45it/s][A
 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 223/252 [00:05<00:00, 35.66it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 229/252 [00:05<00:00, 40.99it/s][A
 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 235/252 [00:06<00:00, 38.84it/s][A
 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 240/252 [00:06<00:00, 38.10it/s][A
 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 245/252 [00:06<00:00, 40.56it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 251/252 [00:06<00:00, 38.50it/s][A
                                                 [AConvert format:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:27<00:13, 13.58s/it]
  0%|          | 0/148 [00:00<?, ?it/s][A
  1%|          | 1/148 [00:00<00:20,  7.33it/s][A
  6%|â–Œ         | 9/148 [00:00<00:03, 43.78it/s][A
 10%|â–ˆ         | 15/148 [00:00<00:03, 38.88it/s][A
 14%|â–ˆâ–Ž        | 20/148 [00:00<00:03, 37.86it/s][A
 17%|â–ˆâ–‹        | 25/148 [00:00<00:03, 40.95it/s][A
 21%|â–ˆâ–ˆ        | 31/148 [00:00<00:03, 38.47it/s][A
 24%|â–ˆâ–ˆâ–       | 36/148 [00:00<00:02, 37.78it/s][A
 28%|â–ˆâ–ˆâ–Š       | 41/148 [00:01<00:02, 40.54it/s][A
 32%|â–ˆâ–ˆâ–ˆâ–      | 47/148 [00:01<00:02, 38.53it/s][A
 34%|â–ˆâ–ˆâ–ˆâ–      | 51/148 [00:01<00:02, 35.69it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–Š      | 57/148 [00:01<00:02, 41.29it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 63/148 [00:01<00:02, 38.96it/s][A
 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 68/148 [00:01<00:02, 38.20it/s][A
 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 73/148 [00:01<00:01, 40.70it/s][A
 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 79/148 [00:02<00:01, 38.70it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 84/148 [00:02<00:01, 38.00it/s][A
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 89/148 [00:02<00:01, 40.55it/s][A
 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 95/148 [00:02<00:01, 38.52it/s][A
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 99/148 [00:02<00:01, 35.71it/s][A
 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 105/148 [00:02<00:01, 41.05it/s][A
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 111/148 [00:02<00:00, 38.78it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 116/148 [00:03<00:00, 38.08it/s][A
 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 121/148 [00:03<00:00, 40.56it/s][A
 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 127/148 [00:03<00:00, 38.56it/s][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 131/148 [00:03<00:00, 35.78it/s][A
 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 137/148 [00:03<00:00, 41.08it/s][A
 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 143/148 [00:03<00:00, 38.91it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 148/148 [00:03<00:00, 38.31it/s][A
                                                 [AConvert format: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:35<00:00, 10.77s/it]Convert format: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:35<00:00, 11.72s/it]
/home/lambda/.local/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py:262: UserWarning: torch.distributed.reduce_op is deprecated, please use torch.distributed.ReduceOp instead
  warnings.warn(
warmup - generate
benchmark - generate
Outputs:
----------------------------------------------------------------------
0: Paris is the capital city of France. It is the most visited city in the world. It is also the most visited city in Europe. It is the most visited city in the world.
----------------------------------------------------------------------
3: Paris is the capital city of France. It is the most visited city in the world. It is also the most visited city in Europe. It is the most visited city in the world.
----------------------------------------------------------------------

TorchDevice: cuda:0
  cur_mem: 0.0000 GB,  peak_mem: 2.9085 GB
TorchDevice: cpu
  cur_mem: 24.4209 GB,  peak_mem: 0.0000 GB
model size: 23.921 GB	cache size: 1.660 GB	hidden size (p): 0.021 GB
peak gpu mem: 2.908 GB	projected: False
prefill latency: 4.205 s	prefill throughput: 486.996 token/s
decode latency: 129.830 s	decode throughput: 0.955 token/s
total latency: 134.035 s	total throughput: 0.955 token/s
